{"ast":null,"code":"import React,{useState,useRef}from'react';import{X,Image}from'lucide-react';import{toast}from'react-hot-toast';import{useChatStore}from'../store/useChatStore';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MessageInput=()=>{const[text,setText]=useState(\"\");const[imagePreview,setImagePreview]=useState(null);const fileInputRef=useRef(null);const{sendMessage}=useChatStore();const handleImageChange=e=>{const file=e.target.files[0];if(file&&!file.type.startsWith(\"image/\")){toast.error(\"Please upload an image file\");return;}const reader=new FileReader();reader.onload=()=>{setImagePreview(reader.result);};if(file){reader.readAsDataURL(file);}};const removeImage=()=>{setImagePreview(null);if(fileInputRef.current){fileInputRef.current.value=\"\";// Clear the file input\n}};const handleSendMessage=async e=>{e.preventDefault();if(!text.trim()&&!imagePreview){return;}try{await sendMessage({text:text.trim(),image:imagePreview});console.log(\"Message sent successfully\");// Clear form\nsetText(\"\");setImagePreview(null);if(fileInputRef.current){fileInputRef.current.value=\"\";// Clear the file input\n}}catch(error){console.error(\"Error sending message:\",error);toast.error(\"Failed to send message\");}};const isSendDisabled=!text.trim()&&!imagePreview;// Disable button if no text or image\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 w-full border-t\",children:[imagePreview&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-3 flex items-center gap-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:imagePreview,alt:\"Preview\",className:\"w-20 h-20 object-cover rounded-lg\"}),/*#__PURE__*/_jsx(\"button\",{onClick:removeImage,className:\"absolute top-2 right-2 p-1 bg-base-200 rounded-full\",type:\"button\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4 text-base-content\"})})]})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSendMessage,className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"w-full input input-bordered rounded-lg input-sm sm:input-md\",placeholder:\"Type a message...\",value:text,onChange:e=>setText(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",ref:fileInputRef,onChange:handleImageChange,className:\"hidden\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"hidden sm:flex btn btn-circle \".concat(imagePreview?\"text-emerald-500\":\"text-zinc-400\"),onClick:()=>{var _fileInputRef$current;return(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();},children:/*#__PURE__*/_jsx(Image,{size:20})})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary btn-sm sm:btn-md\",disabled:isSendDisabled// Disable based on condition\n,children:\"Send\"})]})]});};export default MessageInput;","map":{"version":3,"names":["React","useState","useRef","X","Image","toast","useChatStore","jsx","_jsx","jsxs","_jsxs","MessageInput","text","setText","imagePreview","setImagePreview","fileInputRef","sendMessage","handleImageChange","e","file","target","files","type","startsWith","error","reader","FileReader","onload","result","readAsDataURL","removeImage","current","value","handleSendMessage","preventDefault","trim","image","console","log","isSendDisabled","className","children","src","alt","onClick","onSubmit","placeholder","onChange","accept","ref","concat","_fileInputRef$current","click","size","disabled"],"sources":["/Users/achintiii/chat-app/frontend/src/components/MessageInput.jsx"],"sourcesContent":["import React, { useState, useRef } from 'react';\nimport { X, Image } from 'lucide-react';\nimport { toast } from 'react-hot-toast';\nimport { useChatStore } from '../store/useChatStore';\n\nconst MessageInput = () => {\n    const [text, setText] = useState(\"\");\n    const [imagePreview, setImagePreview] = useState(null);\n    const fileInputRef = useRef(null);\n    const { sendMessage } = useChatStore();\n\n    const handleImageChange = (e) => {\n        const file = e.target.files[0];\n        if (file && !file.type.startsWith(\"image/\")) {\n            toast.error(\"Please upload an image file\");\n            return;\n        }\n\n        const reader = new FileReader();\n        reader.onload = () => {\n            setImagePreview(reader.result);\n        };\n        if (file) {\n            reader.readAsDataURL(file);\n        }\n    };\n\n    const removeImage = () => {\n        setImagePreview(null);\n        if (fileInputRef.current) {\n            fileInputRef.current.value = \"\"; // Clear the file input\n        }\n    };\n\n    const handleSendMessage = async (e) => {\n        e.preventDefault();\n        if (!text.trim() && !imagePreview) {\n            return;\n        }\n        try {\n            await sendMessage({ text: text.trim(), image: imagePreview });\n            console.log(\"Message sent successfully\");\n\n            // Clear form\n            setText(\"\");\n            setImagePreview(null);\n            if (fileInputRef.current) {\n                fileInputRef.current.value = \"\"; // Clear the file input\n            }\n        } catch (error) {\n            console.error(\"Error sending message:\", error);\n            toast.error(\"Failed to send message\");\n        }\n    };\n\n    const isSendDisabled = !text.trim() && !imagePreview; // Disable button if no text or image\n\n    return (\n        <div className=\"p-4 w-full border-t\">\n            {/* Image preview section */}\n            {imagePreview && (\n                <div className=\"mb-3 flex items-center gap-2\">\n                    <div className=\"relative\">\n                        <img\n                            src={imagePreview}\n                            alt=\"Preview\"\n                            className=\"w-20 h-20 object-cover rounded-lg\"\n                        />\n                        <button\n                            onClick={removeImage}\n                            className=\"absolute top-2 right-2 p-1 bg-base-200 rounded-full\"\n                            type=\"button\"\n                        >\n                            <X className=\"w-4 h-4 text-base-content\" />\n                        </button>\n                    </div>\n                </div>\n            )}\n\n            {/* Input form */}\n            <form onSubmit={handleSendMessage} className=\"flex items-center gap-2\">\n                <div className=\"flex-1 flex gap-2\">\n                    {/* Text input */}\n                    <input\n                        type=\"text\"\n                        className=\"w-full input input-bordered rounded-lg input-sm sm:input-md\"\n                        placeholder=\"Type a message...\"\n                        value={text}\n                        onChange={(e) => setText(e.target.value)}\n                    />\n\n                    {/* File input */}\n                    <input\n                        type=\"file\"\n                        accept=\"image/*\"\n                        ref={fileInputRef}\n                        onChange={handleImageChange}\n                        className=\"hidden\"\n                    />\n\n                    {/* Image upload button */}\n                    <button\n                        type=\"button\"\n                        className={`hidden sm:flex btn btn-circle ${\n                            imagePreview ? \"text-emerald-500\" : \"text-zinc-400\"\n                        }`}\n                        onClick={() => fileInputRef.current?.click()}\n                    >\n                        <Image size={20} />\n                    </button>\n                </div>\n\n                {/* Send button */}\n                <button\n                    type=\"submit\"\n                    className=\"btn btn-primary btn-sm sm:btn-md\"\n                    disabled={isSendDisabled} // Disable based on condition\n                >\n                    Send\n                </button>\n            </form>\n        </div>\n    );\n};\n\nexport default MessageInput;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}