{"ast":null,"code":"import{create}from\"zustand\";import{axiosInstance}from\"../lib/axios\";import{toast}from\"react-hot-toast\";import io from\"socket.io-client\";const BASE_URL=\"http://localhost:5001\";export const useAuthStore=create((set,get)=>({authUser:null,isSigningUp:false,isLoggingIn:false,isUpdatingProfile:false,isCheckingAuth:true,onlineUsers:[],socket:null,// Check authentication status\ncheckAuth:async()=>{set({isCheckingAuth:true});try{const response=await axiosInstance.get(\"http://localhost:5001/api/auth/check\");set({authUser:response.data});get().connectSocket();}catch(error){console.error(error);set({authUser:null});}finally{set({isCheckingAuth:false});}},// Signup function\nsignup:async formData=>{set({isSigningUp:true});try{const res=await axiosInstance.post(\"http://localhost:5001/api/auth/signup\",formData);toast.success(\"Account created successfully!\");set({authUser:res.data});get().connectSocket();}catch(error){console.error(\"Error during signup:\",error);toast.error(\"Error during signup\");}finally{set({isSigningUp:false});}},// Login function\nlogin:async formData=>{set({isLoggingIn:true});try{const res=await axiosInstance.post(\"http://localhost:5001/api/auth/login\",formData);set({authUser:res.data});toast.success(\"Logged in successfully!\");get().connectSocket();}catch(error){console.error(\"Error during login:\",error);toast.error(\"Invalid email or password. Please try again.\");}finally{set({isLoggingIn:false});}},// Logout function\nlogout:async()=>{try{await axiosInstance.post(\"http://localhost:5001/api/auth/logout\");set({authUser:null});toast.success(\"Logged out successfully!\");get().disconnectSocket();}catch(error){console.error(\"Error during logout:\",error);toast.error(\"Error during logout\");}},// Update profile\nupdateProfile:async data=>{set({isUpdatingProfile:true});try{const res=await axiosInstance.put(\"http://localhost:5001/api/auth/update-profile\",data);set({authUser:res.data});toast.success(\"Profile updated successfully\");}catch(error){console.error(\"Error updating profile:\",error);toast.error(\"Error updating profile\");}finally{set({isUpdatingProfile:false});}},connectSocket:()=>{var _get$socket;const{authUser}=get();if(!authUser||(_get$socket=get().socket)!==null&&_get$socket!==void 0&&_get$socket.connected){return;}const socket=io(BASE_URL,{query:{userId:authUser._id}});socket.connect();set({socket:socket});socket.on(\"getOnlineUsers\",userIds=>{set({onlineUsers:userIds});});},disconnectSocket:()=>{var _get$socket2;if((_get$socket2=get().socket)!==null&&_get$socket2!==void 0&&_get$socket2.connected){get().socket.disconnect();}}}));","map":{"version":3,"names":["create","axiosInstance","toast","io","BASE_URL","useAuthStore","set","get","authUser","isSigningUp","isLoggingIn","isUpdatingProfile","isCheckingAuth","onlineUsers","socket","checkAuth","response","data","connectSocket","error","console","signup","formData","res","post","success","login","logout","disconnectSocket","updateProfile","put","_get$socket","connected","query","userId","_id","connect","on","userIds","_get$socket2","disconnect"],"sources":["/Users/achintiii/chat-app/frontend/src/store/useAuthStore.js"],"sourcesContent":["import { create } from \"zustand\";\nimport { axiosInstance } from \"../lib/axios\";\nimport {toast} from \"react-hot-toast\";\nimport io from \"socket.io-client\";\n\nconst BASE_URL = \"http://localhost:5001\";\nexport const useAuthStore = create((set, get) => ({\n    authUser: null,\n    isSigningUp: false,\n    isLoggingIn: false,\n    isUpdatingProfile: false,\n    isCheckingAuth: true,\n    onlineUsers: [],\n    socket : null,\n    // Check authentication status\n    checkAuth: async () => {\n        set({ isCheckingAuth: true });\n        try {\n            const response = await axiosInstance.get(\"http://localhost:5001/api/auth/check\");\n            set({ authUser: response.data });\n            get().connectSocket();\n        } catch (error) {\n            console.error(error);\n            set({ authUser: null });\n        } finally {\n            set({ isCheckingAuth: false });\n        }\n    },\n\n    // Signup function\n    signup: async (formData) => {\n        set({ isSigningUp: true });\n        try {\n            const res = await axiosInstance.post(\"http://localhost:5001/api/auth/signup\", formData);\n            toast.success(\"Account created successfully!\");\n            set({ authUser: res.data });\n\n            get().connectSocket();\n        } catch (error) {\n            console.error(\"Error during signup:\", error);\n            toast.error(\"Error during signup\");\n        } finally {\n            set({ isSigningUp: false });\n        }\n    },\n\n    // Login function\n    login: async (formData) => {\n        set({ isLoggingIn: true });\n        try {\n            const res = await axiosInstance.post(\"http://localhost:5001/api/auth/login\", formData);\n            set({ authUser: res.data });\n            toast.success(\"Logged in successfully!\");\n\n            get().connectSocket();\n        } catch (error) {\n            console.error(\"Error during login:\", error);\n            toast.error(\"Invalid email or password. Please try again.\");\n        } finally {\n            set({ isLoggingIn: false });\n        }\n    },\n\n    // Logout function\n    logout: async () => {\n        try {\n            await axiosInstance.post(\"http://localhost:5001/api/auth/logout\");\n            set({ authUser: null });\n            toast.success(\"Logged out successfully!\");\n            get().disconnectSocket();\n        } catch (error) {\n            console.error(\"Error during logout:\", error);\n            toast.error(\"Error during logout\");\n        }\n    },\n\n    // Update profile\n    updateProfile: async (data) => {\n        set({ isUpdatingProfile: true });\n        try {\n            const res = await axiosInstance.put(\"http://localhost:5001/api/auth/update-profile\", data);\n            set({ authUser: res.data });\n            toast.success(\"Profile updated successfully\");\n            \n        } catch (error) {\n            console.error(\"Error updating profile:\", error);\n            toast.error(\"Error updating profile\");\n        } finally {\n            set({ isUpdatingProfile: false });\n        }\n    },\n    connectSocket: () => {\n        const {authUser} = get();\n        if(!authUser || get().socket?.connected) {\n            return;\n        }\n       const socket = io(BASE_URL, {\n           query: {userId: authUser._id},\n       });\n       socket.connect();\n       set ({socket: socket});\n\n       socket.on(\"getOnlineUsers\", (userIds) => {\n           set({onlineUsers: userIds});\n       });\n    },\n    disconnectSocket: () => {\n        if(get().socket?.connected) {\n            get().socket.disconnect();\n        }\n    }\n\n}));\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}